extend type Query {
  barcodeScan(barcode: String!, searchMode: Boolean): Product! @isAuthenticated
  allProducts(
    paginator: PaginatorInput!
    search: ProductSearch
  ): PaginatedProducts! @isAuthenticated
  allBrands: [Brand!]! @isAuthenticated
  product(id: ID!, viewerTrail: ViewerTrailInput): Product! @isAuthenticated
  extractProductFields(base64Image: String!): ProductExtractionResponse!
    @isAuthenticated
  myProductViewHistory(paginator: PaginatorInput!): PaginatedProducts! @isAuthenticated
}

extend type Mutation {
  createProduct(input: CreateProduct!): Product!
    @isAuthenticated(role: "CONTRIBUTOR")
  updateProduct(id: ID!, input: UpdateProduct!): Product!
    @isAuthenticated(role: "CONTRIBUTOR")
  saveProductsFromUPCItemDb(input: SaveExternalProductInput!): SearchResult!
    @isAuthenticated(role: "SUPER_ADMIN")
}

type PaginatedProducts {
  products: [Product!]!
  paginator: Paginator!
}

type Brand {
  brand: String! @goTag(key: "alias", value: "product.brand")
  products: Int64!
}

type Product {
  id: ID! @goTag(key: "sql", value: "primary_key")
  name: String!
  image: String!
  description: String!
  url: String
  brand: String!
  code: String!
  color: String
  model: String
  categoryId: ID!
  category: Category
  stock: Stock
  weightValue: Float
  weightType: String
  quantityValue: Int!
  quantityType: String!
  lowestRecordedPrice: Float
  highestRecordedPrice: Float
  createdAt: Time!
  updatedAt: Time!
  createdById: ID
  createdBy: CreatedByUser
  updatedById: ID
  updatedBy: UpdatedByUser
  productList: [ProductList!]!
  views: Int!
}

type SearchResult {
  total: Int!
  added: Int!
  failed: Int!
}

type ProductExtractionFields {
  brand: String!
  productName: String!
  weight: String
  quantity: Int
  category: String!
}

type ProductExtractionResponse {
  brand: String!
  name: String!
  weight: String
  quantity: Int
  categoryId: ID
  category: Category
}

input CreateProduct {
  name: String! @goTag(key: "validate", value: "required")
  description: String!
  url: String @goTag(key: "validate", value: "omitempty,http_url")
  brand: String!
  code: String! @goTag(key: "validate", value: "required")
  color: String
  model: String
  categoryId: ID! @goTag(key: "validate", value: "required")
  weight: String
  quantityValue: Int
  quantityType: String
  lowestRecordedPrice: Float
  highestRecordedPrice: Float
  imageFile: Upload
  imageBase64: String
  imageUrl: String @goTag(key: "validate", value: "omitempty,http_url")
}

input UpdateProduct {
  name: String
  description: String
  url: String @goTag(key: "validate", value: "omitempty,http_url")
  brand: String
  code: String
  color: String
  model: String
  categoryId: ID
  weight: String
  quantityValue: Int
  quantityType: String
  lowestRecordedPrice: Float
  highestRecordedPrice: Float
  imageFile: Upload
  imageBase64: String
}

input ProductSearch {
  query: String
  category: String
  categoryId: ID
  branchId: ID
  location: LocationInput
  storeId: ID
}

input SaveExternalProductInput {
  numPagesToQuery: Int!
  search: String!
  category: String
  brand: String
  upc: String
  offset: Int
}

input ViewerTrailInput {
  stockId: ID
  origin: String
}
