extend type Query {
  barcodeScan(barcode: String!, searchMode: Boolean): Product!
  allProducts(
    paginator: PaginatorInput!
    search: ProductSearch
  ): PaginatedProducts!
  allBrands: [Brand!]!
  product(id: ID!, viewerTrail: ViewerTrailInput): Product!
  extractProductFields(base64Image: String!): ProductExtractionResponse!
    @isAuthenticated
  myProductViewHistory(paginator: PaginatorInput!): PaginatedProducts!
    @isAuthenticated
  getProductNutritionData(productId: ID!): ProductNutrition!
  productSearch(paginator: PaginatorInput!, search: String!): PaginatedProducts!
  weightComponentsFromCategoryId(categoryId: ID!): [ProductWeightComponents!]!
}

extend type Mutation {
  createProduct(input: CreateProduct!): Product!
    @isAuthenticated(role: "CONTRIBUTOR")
  updateProduct(id: ID!, input: UpdateProduct!): Product!
    @isAuthenticated(role: "CONTRIBUTOR")
  saveProductsFromUPCItemDb(input: SaveExternalProductInput!): SearchResult!
    @isAuthenticated(role: "SUPER_ADMIN")
  updateProductNutritionData(productId: ID!): ProductNutrition!
    @isAuthenticated(role: "CONTRIBUTOR")
  extractAndCreateProduct(barcode: String!, base64Image: String!): Product!
    @isAuthenticated
}

type PaginatedProducts {
  products: [Product!]!
  paginator: Paginator!
}

type Brand {
  brand: String! @goTag(key: "alias", value: "product.brand")
  products: Int64!
}

type Product {
  id: ID! @goTag(key: "sql", value: "primary_key")
  name: String!
  image: String!
  description: String!
  brand: String!
  code: String!
  model: String
  categoryId: ID!
  category: Category
  stock: Stock
  weightValue: Float
  weightType: String
  quantityValue: Int!
  quantityType: String!
  views: Int!

  createdAt: Time!
  updatedAt: Time!

  productList: [ProductList!]!
}

type ProductSimple {
  id: ID! @goTag(key: "sql", value: "primary_key")
  name: String!
  image: String!
  description: String!
  brand: String!
  code: String!
  model: String
  categoryId: ID!
  category: Category
  stock: StockSimple @goTag(key: "alias", value: "stock")
  weightValue: Float
  weightType: String
  quantityValue: Int!
  quantityType: String!
  views: Int!

  createdAt: Time!
  updatedAt: Time!
}

type SearchResult {
  total: Int!
  added: Int!
  failed: Int!
}

type ProductExtractionFields {
  brand: String!
  productName: String!
  weight: String
  quantity: Int
  category: String!
}

type ProductExtractionResponse {
  brand: String!
  name: String!
  weight: String
  quantity: Int
  categoryId: ID
  category: Category
}

type ProductWeightComponents {
  weightValue: Float! @goTag(key: "alias", value: "product.weight_value")
  weightType: String! @goTag(key: "alias", value: "product.weight_type")
}

input CreateProduct {
  name: String! @goTag(key: "validate", value: "required")
  description: String!
  brand: String!
  code: String! @goTag(key: "validate", value: "required")
  model: String
  categoryId: ID! @goTag(key: "validate", value: "required")
  weight: String
  quantityValue: Int
  quantityType: String
  imageFile: Upload
  imageBase64: String
  imageUrl: String @goTag(key: "validate", value: "omitempty,http_url")
}

input UpdateProduct {
  name: String
  description: String
  brand: String
  code: String
  model: String
  categoryId: ID
  weight: String
  quantityValue: Int
  quantityType: String
  imageFile: Upload
  imageBase64: String
}

input ProductSearch {
  query: String
  category: String
  categoryId: ID
  branchId: ID
  branchIds: [ID!]
  location: LocationInput
  storeId: ID
  sale: Boolean
  sortByPrice: String
  weight: String
  quantity: Int
  brand: String
}

input SaveExternalProductInput {
  numPagesToQuery: Int!
  search: String!
  category: String
  brand: String
  upc: String
  offset: Int
}

input ViewerTrailInput {
  stockId: ID
  origin: String
}
